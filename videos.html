<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Videos</title>
  <style>
    :root{
      --bg1:#a78bfa; --bg2:#f472b6; --card:#0b1227; --ink:#fff; --muted:#cbd5e1;
    }
    *{box-sizing:border-box}
    body{margin:0;min-height:100vh;display:grid;place-items:center;background:linear-gradient(135deg,var(--bg1),var(--bg2));font-family:system-ui,Segoe UI,Inter,Arial,sans-serif;color:var(--ink)}
    .wrap{width:min(900px,92vw);background:var(--card);border-radius:16px;box-shadow:0 12px 30px #0006;border:1px solid #ffffff22;overflow:hidden}
    header{display:flex;align-items:center;justify-content:space-between;padding:16px 18px;background:#0f1835}
    header h1{margin:0;font-size:18px}
    header a{color:#0b1227;background:#fff;padding:10px 14px;border-radius:10px;text-decoration:none;font-weight:700}

    .content{padding:18px}
    .player{border:1px solid #ffffff22;border-radius:12px;overflow:hidden;background:#091027}
    .meta{display:flex;align-items:center;justify-content:space-between;gap:12px;margin-top:10px}
    .title{font-weight:700}
    .muted{color:var(--muted);font-size:14px}

    .controls{display:flex;gap:10px;flex-wrap:wrap;margin-top:12px}
    .btn{appearance:none;border:0;border-radius:10px;padding:12px 14px;font-weight:700;cursor:pointer}
    .primary{background:linear-gradient(90deg,#22c55e,#86efac);color:#08250f}
    .ghost{background:#ffffff12;color:#fff;border:1px solid #ffffff22}
    .btn[disabled]{opacity:.5;cursor:not-allowed}

    .playlist{display:grid;grid-template-columns:repeat(3,1fr);gap:10px;margin-top:14px}
    .tile{padding:12px;border-radius:10px;background:#0f1835;border:1px solid #ffffff1a}
    .tile.locked{opacity:.5}
    .badge{font-size:12px;color:#94a3b8}
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <h1>üé¨ Video Series</h1>
      <a href="home.html">‚Üê Home</a>
    </header>
    <div class="content">
      <div class="player">
        <video id="vid" width="100%" controls preload="metadata" poster="" style="display:block">
          <!-- sources injected by JS -->
        </video>
      </div>

      <div class="meta">
        <div>
          <div class="title" id="vTitle">Episode 1</div>
          <div class="muted" id="vNote">You must watch each video to unlock the next.</div>
        </div>
        <div class="muted"><span id="vPos">1</span>/<span id="vTotal">3</span></div>
      </div>

      <div class="controls">
        <button id="prevBtn" class="btn ghost">Previous</button>
        <button id="nextBtn" class="btn primary" disabled>Next ‚ñ∂</button>
      </div>

      <div class="playlist" id="list"></div>
    </div>
  </div>

  <script>
    // Configure your playlist here (title, src, optional poster)
    const PLAYLIST = [
      { title: 'Episode 1 ‚Äî The Beginning', src: 'happy 40 willie.mp4', poster: '' },
      { title: 'Episode 2 ‚Äî Memory Lane',    src: 'video2.mp4', poster: '' },
      { title: 'Episode 3 ‚Äî The Finale',     src: 'video3.mp4', poster: '' },
    ];

    // State
    const vid = document.getElementById('vid');
    const nextBtn = document.getElementById('nextBtn');
    const prevBtn = document.getElementById('prevBtn');
    const vTitle = document.getElementById('vTitle');
    const vPos = document.getElementById('vPos');
    const vTotal = document.getElementById('vTotal');
    const list = document.getElementById('list');

    let index = Number(sessionStorage.getItem('video_index') || 0);
    let unlocked = JSON.parse(sessionStorage.getItem('video_unlocked') || '[]');
    if(unlocked.length === 0){ unlocked = [0]; } // only first is unlocked at start

    vTotal.textContent = PLAYLIST.length;

    function load(i){
      index = i;
      sessionStorage.setItem('video_index', String(index));
      // update video source
      vid.innerHTML = '';
      const s = document.createElement('source');
      s.src = PLAYLIST[i].src; s.type = 'video/mp4';
      vid.appendChild(s);
      vid.poster = PLAYLIST[i].poster || '';
      vid.load();
      vid.currentTime = 0;
      nextBtn.disabled = true; // ghost next until video ends
      vTitle.textContent = PLAYLIST[i].title;
      vPos.textContent = i + 1;
      renderList();
    }

    function renderList(){
      list.innerHTML = '';
      PLAYLIST.forEach((item, i) => {
        const tile = document.createElement('button');
        tile.className = 'tile' + (unlocked.includes(i) ? '' : ' locked');
        tile.innerHTML = `<div class="badge">Episode ${i+1}</div><div>${item.title}</div>`;
        tile.disabled = !unlocked.includes(i);
        tile.onclick = () => load(i);
        list.appendChild(tile);
      });

      prevBtn.disabled = index === 0;
    }

    // When a video ends, unlock Next and the next episode
    vid.addEventListener('ended', () => {
      nextBtn.disabled = false;
      const next = index + 1;
      if(next < PLAYLIST.length && !unlocked.includes(next)){
        unlocked.push(next);
        sessionStorage.setItem('video_unlocked', JSON.stringify(unlocked));
        renderList();
      }
    });

    nextBtn.addEventListener('click', () => {
      const next = Math.min(index + 1, PLAYLIST.length - 1);
      load(next);
    });

    prevBtn.addEventListener('click', () => {
      const prev = Math.max(index - 1, 0);
      load(prev);
    });

    // init
    if(!unlocked.includes(index)) index = 0;
    load(index);
  </script>
</body>
</html>
