<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ðŸŽ‰ 40th Birthday Escape</title>
  <style>
    :root{
      --bg: #0f172a;          /* slate-900 */
      --card: #0b1227;        /* deep indigo */
      --ink: #e2e8f0;         /* slate-200 */
      --muted: #94a3b8;       /* slate-400 */
      --brand1: #a78bfa;      /* purple-400 */
      --brand2: #f472b6;      /* pink-400 */
      --good: #22c55e;        /* green-500 */
      --bad: #ef4444;         /* red-500 */
      --accent: linear-gradient(90deg, var(--brand1), var(--brand2));
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0; background: radial-gradient(1200px 600px at 10% -10%, #1f2a4a 0%, transparent 60%),
                                     radial-gradient(1200px 600px at 110% 10%, #2a174a 0%, transparent 60%),
                                     var(--bg);
      color:var(--ink); font-family: system-ui, -apple-system, Segoe UI, Roboto, Inter, Arial, sans-serif;
    }
    .wrap{max-width:960px;margin:0 auto;padding:24px}
    header{display:flex;align-items:center;gap:16px;justify-content:space-between}
    .title{display:flex;align-items:center;gap:12px}
    .badge{width:44px;height:44px;border-radius:14px;background:#fff1;display:grid;place-items:center;border:1px solid #fff2}
    h1{font-size:clamp(22px,2.4vw,32px);margin:0}
    .progress{height:10px;background:#fff1;border-radius:999px;overflow:hidden;border:1px solid #fff2;min-width:200px}
    .bar{height:100%;background:var(--accent);width:0%}

    .card{background:linear-gradient(180deg, #0d1530, #0a0f22);border:1px solid #ffffff22;border-radius:18px;padding:20px;margin-top:18px;box-shadow:0 10px 30px #0006}
    .card h2{margin:.2rem 0 0.2rem;font-size:1.25rem}
    .muted{color:var(--muted)}
    .row{display:flex;gap:12px;flex-wrap:wrap}
    .btn{appearance:none;border:0;border-radius:12px;padding:12px 16px;background:var(--accent);color:#0b0b13;font-weight:700;cursor:pointer;box-shadow:0 4px 14px #0006;transition:transform .06s ease, opacity .2s}
    .btn[disabled]{opacity:.5;cursor:not-allowed;box-shadow:none}
    .btn:active{transform:translateY(1px)}
    .ghost{background:#ffffff12;color:var(--ink);border:1px solid #ffffff22}
    input[type="text"], input[type="number"], .pin input{
      background:#0b1227;border:1px solid #ffffff22;color:var(--ink);
      padding:12px;border-radius:12px;outline:none;width:100%;
    }
    input:focus{border-color:#ffffff55}
    .pin{display:flex;gap:10px}
    .pin input{width:64px;text-align:center;font-size:28px}
    .status{margin-top:8px;font-weight:700}
    .ok{color:var(--good)}
    .bad{color:var(--bad)}

    /* Hidden image grid */
    .reveal-wrap{position:relative;aspect-ratio:16/9;border-radius:16px;overflow:hidden;border:1px solid #ffffff22}
    .reveal-img{position:absolute;inset:0;background:url('https://images.unsplash.com/photo-1520985245844-9a3c979a1be0?q=80&w=1600&auto=format&fit=crop') center/cover no-repeat;filter:saturate(1.15)}
    .tiles{position:absolute;inset:0;display:grid;gap:4px;padding:4px}
    .tile{background:#0b1120;opacity:.96;border:1px solid #ffffff0f;border-radius:6px;cursor:pointer;transition:opacity .25s ease, transform .15s ease}
    .tile:active{transform:scale(.98)}
    .tile.gone{opacity:0;pointer-events:none}

    .footer-note{margin:24px 4px;color:#90a4c1;font-size:12px}
    .hint{font-size:12px;color:#9fb3d9}
    .divider{height:1px;background:#ffffff1a;margin:16px 0}
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <div class="title">
        <div class="badge">ðŸŽ‚</div>
        <div>
          <h1>Birthday Escape</h1>
          <div class="muted">Solve each puzzle to reveal the next surprise âœ¨</div>
        </div>
      </div>
      <div class="progress" aria-label="progress"><div id="progressBar" class="bar" style="width:0%"></div></div>
    </header>

    <!-- ROOM 1: Code Lock (3-digit) -->
    <section id="room1" class="card" aria-live="polite">
      <h2>Room 1 Â· The Code Lock</h2>
      <p class="muted">Enter the 3â€‘digit code to unlock the door. <span class="hint">(Tip: It could be a code)</span></p>
      <div class="row" style="align-items:center;margin-top:10px">
        <div class="pin" aria-label="3 digit pin">
          <input inputmode="numeric" maxlength="1" aria-label="Digit 1" />
          <input inputmode="numeric" maxlength="1" aria-label="Digit 2" />
          <input inputmode="numeric" maxlength="1" aria-label="Digit 3" />
        </div>
        <button id="checkPin" class="btn">Unlock</button>
        <button id="hint1" class="btn ghost">Hint</button>
      </div>
      <div id="pinStatus" class="status" role="status"></div>
    </section>

    <!-- ROOM 2: Riddle -->
    <section id="room2" class="card" hidden>
      <h2>Room 2 Â· Aquatic Riddle</h2>
      <p class="muted">A dishonest fish</p>
      <div class="row" style="align-items:center;margin-top:10px">
        <input id="riddleInput" type="text" placeholder="Type your answer" aria-label="Riddle answer" />
        <button id="checkRiddle" class="btn">Submit</button>
        <button id="hint2" class="btn ghost">Hint</button>
      </div>
      <div id="riddleStatus" class="status" role="status"></div>
    </section>

    <!-- ROOM 3: Hidden Image Reveal -->
    <section id="room3" class="card" hidden>
      <h2>Room 3 Â· Picture Puzzle</h2>
      <p class="muted">Clear all the tiles to reveal the surprise photo! Click each tile to remove it. ðŸ§©</p>
      <div class="reveal-wrap" style="margin-top:10px">
        <div class="reveal-img" id="revealImage" role="img" aria-label="Hidden memory image"></div>
        <div class="tiles" id="tilesGrid"></div>
      </div>
      <div class="row" style="margin-top:12px">
        <button id="finishBtn" class="btn" disabled>Continue</button>
        <button id="shuffleBtn" class="btn ghost">Shuffle Tiles</button>
      </div>
      <div class="hint" style="margin-top:6px">Happy Birthday Ria!.</div>
    </section>


  <!-- FINALE -->
  <section id="finale" class="card" hidden>
    <h2>Finale Â· Happy 40th! ðŸŽ‰</h2>
    <p>Surprise unlocked! <span class="muted">Press play â†“</span></p>

    <!-- Responsive YouTube embed -->
    <div style="position:relative;padding-bottom:56.25%;height:0;border-radius:12px;overflow:hidden;border:1px solid #ffffff22;margin:12px 0 8px;">
      <iframe
        src="https://www.youtube.com/embed/3dwvOYDB3PI?rel=0&modestbranding=1&playsinline=1"
        title="Finale Video"
        allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
        allowfullscreen
        style="position:absolute;inset:0;width:100%;height:100%;border:0;">
      </iframe>
    </div>

    <div class="divider"></div>
    <button id="restart" class="btn ghost">Replay from start</button>
  </section>


    <div class="footer-note"></div>
  </div>

  <script>
    // =============================
    //  CONFIG â€” customize here ðŸ‘‡
    // =============================
    const PIN_CODE = ["4","0","4"]; // 3-digit unlock code (strings)
    const PIN_HINT = "Website not found. but watch the video again.";

    const RIDDLE_ANSWER = ["lionfish"]; // lowercase answers
    const RIDDLE_HINT = "Cannot trust that fish he speaks no truth";

    const GRID_COLS = 4;      // tile columns
    const GRID_ROWS = 4;      // tile rows
    const IMAGE_URL = "static/Logos/date.JPG"; 

    // =============================
    //  UTILITIES
    // =============================
    const $ = (sel, root=document) => root.querySelector(sel);
    const $$ = (sel, root=document) => Array.from(root.querySelectorAll(sel));
    const show = (el) => el.removeAttribute('hidden');
    const hide = (el) => el.setAttribute('hidden','');

    const rooms = [$('#room1'), $('#room2'), $('#room3'), $('#finale')];
    const progressBar = $('#progressBar');

    function setProgress(i){ // i = index of room unlocked
      const pct = Math.round((i / (rooms.length - 1)) * 100);
      progressBar.style.width = pct + '%';
    }

    function goTo(next){
      rooms.forEach((r, idx) => idx === next ? show(r) : hide(r));
      setProgress(next);
      window.scrollTo({top:0, behavior:'smooth'});
    }

    // =============================
    //  ROOM 1 â€” PIN LOCK
    // =============================
    const pinInputs = $$('#room1 .pin input');
    const pinStatus = $('#pinStatus');

    pinInputs.forEach((inp, idx) => {
      inp.addEventListener('input', (e) => {
        e.target.value = e.target.value.replace(/\D/g,'').slice(0,1);
        if(e.target.value && idx < pinInputs.length - 1){ pinInputs[idx+1].focus(); }
      });
      inp.addEventListener('keydown', (e)=>{
        if(e.key === 'Backspace' && !e.target.value && idx>0) pinInputs[idx-1].focus();
      });
    });

    $('#hint1').addEventListener('click', ()=>{
      pinStatus.textContent = PIN_HINT;
      pinStatus.className = 'status';
    });

    $('#checkPin').addEventListener('click', ()=>{
      const attempt = pinInputs.map(i=>i.value.trim());
      const ok = attempt.length===3 && attempt.every((v,i)=>v===PIN_CODE[i]);
      if(ok){
        pinStatus.textContent = 'Unlocked! âžœ Room 2';
        pinStatus.className = 'status ok';
        setTimeout(()=>goTo(1), 600);
      }else{
        pinStatus.textContent = 'Incorrect code.';
        pinStatus.className = 'status bad';
      }
    });

    // =============================
    //  ROOM 2 â€” RIDDLE
    // =============================
    $('#hint2').addEventListener('click', ()=>{
      const el = $('#riddleStatus');
      el.textContent = RIDDLE_HINT;
      el.className = 'status';
    });

    function checkRiddle(){
      const v = ($('#riddleInput').value || '').trim().toLowerCase();
      const ok = RIDDLE_ANSWER.includes(v);
      const el = $('#riddleStatus');
      if(ok){
        el.textContent = 'Correct! âžœ Room 3';
        el.className = 'status ok';
        setTimeout(()=>goTo(2), 600);
      }else{
        el.textContent = 'Not quite â€” try again.';
        el.className = 'status bad';
      }
    }
    $('#checkRiddle').addEventListener('click', checkRiddle);
    $('#riddleInput').addEventListener('keydown', (e)=>{ if(e.key==='Enter') checkRiddle(); });

    // =============================
    //  ROOM 3 â€” HIDDEN IMAGE GRID
    // =============================
    const tilesGrid = $('#tilesGrid');
    const revealImage = $('#revealImage');
    const finishBtn = $('#finishBtn');
    const shuffleBtn = $('#shuffleBtn');

    function buildTiles(){
      revealImage.style.backgroundImage = `url(${IMAGE_URL})`;
      tilesGrid.style.gridTemplateColumns = `repeat(${GRID_COLS}, 1fr)`;
      tilesGrid.style.gridTemplateRows = `repeat(${GRID_ROWS}, 1fr)`;
      tilesGrid.innerHTML = '';
      const total = GRID_COLS * GRID_ROWS;
      for(let i=0;i<total;i++){
        const tile = document.createElement('button');
        tile.className = 'tile';
        tile.setAttribute('aria-label', 'Cover tile');
        tile.addEventListener('click', ()=>{
          tile.classList.add('gone');
          maybeFinished();
        });
        tilesGrid.appendChild(tile);
      }
      finishBtn.disabled = true;
    }

    function maybeFinished(){
      const remaining = $$('.tile:not(.gone)', tilesGrid).length;
      if(remaining === 0){
        finishBtn.disabled = false;
        finishBtn.focus();
      }
    }

    shuffleBtn.addEventListener('click', ()=>{
      // Randomly toggle ~30% of tiles to gone as a playful shuffle
      const tiles = $$('.tile', tilesGrid);
      tiles.forEach(t=>t.classList.remove('gone'))
      const n = Math.floor(tiles.length * 0.3);
      for(let i=0;i<n;i++){
        const j = Math.floor(Math.random()*tiles.length);
        tiles[j].classList.add('gone');
      }
      maybeFinished();
    });

    finishBtn.addEventListener('click', ()=>{
      goTo(3);
      confettiBurst();
    });

    // Simple confetti (emoji) without libs
    function confettiBurst(){
      const emojis = ['ðŸŽ‰','âœ¨','ðŸŽˆ','ðŸ’–','ðŸ¥³'];
      for(let i=0;i<24;i++){
        const s = document.createElement('div');
        s.textContent = emojis[Math.floor(Math.random()*emojis.length)];
        Object.assign(s.style,{
          position:'fixed', left: Math.random()*100+'vw', top:'-40px', fontSize: (16+Math.random()*24)+'px',
          transition:'transform 1.6s ease-out, opacity 1.6s',
          zIndex:9999
        });
        document.body.appendChild(s);
        requestAnimationFrame(()=>{
          s.style.transform = `translateY(${80+Math.random()*120}vh) rotate(${(Math.random()*360)|0}deg)`;
          s.style.opacity = 0;
        });
        setTimeout(()=>s.remove(), 1700);
      }
    }

    // =============================
    //  INIT
    // =============================
    buildTiles();
    goTo(0);

    // Restart
    $('#restart').addEventListener('click', ()=>{
      pinInputs.forEach(i=>i.value='');
      $('#riddleInput').value='';
      $('#pinStatus').textContent='';
      $('#riddleStatus').textContent='';
      buildTiles();
      goTo(0);
    });
  </script>
</body>
</html>
